<?xml version="1.0"?>
<launch>

  <!-- Panda options -->
  <arg name="arm_id"       default="panda" doc="Name of the panda robot to spawn" />
  <arg name="load_gripper" default="true" />
  <arg name="transmission" default="effort" />

  <!-- Gazebo options -->
  <arg name="gazebo_gui" default="true" doc="Start Gazebo GUI"/>
  <arg name="paused" default="false" doc="Start Gazebo paused"/>

  <!-- Load main franka example controllers YAML -->
  <rosparam file="$(find franka_example_controllers)/config/franka_example_controllers.yaml" subst_value="true" />

  <!-- ✅ Load your compliance params YAML -->
  <rosparam file="$(find franka_art)/config/compliance_params.yaml" subst_value="true"/>

  <!-- Launch the gazebo simulator and spawn the robot -->
  <include file="$(find franka_gazebo)/launch/panda_teleop.launch" pass_all_args="true">
    <arg name="headless" value="$(eval not arg('gazebo_gui'))" />
    <arg name="use_gripper" default="$(arg load_gripper)" />
    <arg name="controller" default="cartesian_impedance_example_controller" />
  </include>

  <!-- ✅ Apply compliance params via dynamic_reconfigure after spawn -->
  <node pkg="dynamic_reconfigure" type="dynparam" name="set_compliance_params"
        args="load /cartesian_impedance_example_controller/dynamic_reconfigure_compliance_param_node
              $(find franka_art)/config/compliance_params.yaml" />

</launch>
